[2025-04-11T19:59:34.043+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: rag_daily_discovery.run_discovery_flow manual__2025-04-11T19:59:30.693673+00:00 [queued]>
[2025-04-11T19:59:34.049+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: rag_daily_discovery.run_discovery_flow manual__2025-04-11T19:59:30.693673+00:00 [queued]>
[2025-04-11T19:59:34.050+0000] {taskinstance.py:2170} INFO - Starting attempt 1 of 1
[2025-04-11T19:59:34.057+0000] {taskinstance.py:2191} INFO - Executing <Task(PythonOperator): run_discovery_flow> on 2025-04-11 19:59:30.693673+00:00
[2025-04-11T19:59:34.066+0000] {standard_task_runner.py:60} INFO - Started process 99 to run task
[2025-04-11T19:59:34.068+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'rag_daily_discovery', 'run_discovery_flow', 'manual__2025-04-11T19:59:30.693673+00:00', '--job-id', '171', '--raw', '--subdir', 'DAGS_FOLDER/rag_daily_discovery.py', '--cfg-path', '/tmp/tmpim89yfvc']
[2025-04-11T19:59:34.069+0000] {standard_task_runner.py:88} INFO - Job 171: Subtask run_discovery_flow
[2025-04-11T19:59:34.100+0000] {task_command.py:423} INFO - Running <TaskInstance: rag_daily_discovery.run_discovery_flow manual__2025-04-11T19:59:30.693673+00:00 [running]> on host 9c72e9db4421
[2025-04-11T19:59:34.209+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='rag_daily_discovery' AIRFLOW_CTX_TASK_ID='run_discovery_flow' AIRFLOW_CTX_EXECUTION_DATE='2025-04-11T19:59:30.693673+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-04-11T19:59:30.693673+00:00'
[2025-04-11T19:59:40.440+0000] {logging_mixin.py:188} INFO - üîç Raw queries from LLM: ['Sure! Here‚Äôs a list of 40 songs or artists known for strong isolated percussion or vocal sections ideal for sampling in Afro, Latin, funk, or world genres:', 'Mongo Santamaria', 'Rubens Bassini', 'Quinta Feira', 'Fela Kuti', 'Tito Puente', 'Jorge Ben Jor', 'Celia Cruz', 'Tortoise', 'Os Mutantes', 'Buena Vista Social Club', 'Antibalas', 'Les Ambassadeurs', 'Bomba Est√©reo', 'Amadou & Mariam', 'Grupo Fantasma', 'Novalima', 'Oumou Sangar√©', 'King Sunny Ad√©', 'Makaya McCraven', 'Altin G√ºn', 'Thundercat', 'Vieux Farka Tour√©', 'Ebo Taylor', 'Os Canalhas', 'The Budos Band', 'Seun Kuti', 'Los Van Van', 'Kotoji', 'Zap Mama', 'The Ex', 'Tinariwen', 'Pongo', 'C.K. Mann', 'The Rhythm of the Saints (Paul Simon)', 'African Head Charge', 'Fanfare Ciocarlia', "Les Amazones d'Afrique", 'Bonga', 'Sidi Tali', 'Soul', 'Feel free to explore these artists and songs for their rich percussion and vocal elements!']
[2025-04-11T19:59:40.441+0000] {logging_mixin.py:188} INFO - üîç Searching for: Mongo Santamaria
[2025-04-11T19:59:40.945+0000] {logging_mixin.py:188} INFO - üîç Searching for: Rubens Bassini
[2025-04-11T19:59:41.552+0000] {logging_mixin.py:188} INFO - üîç Searching for: Quinta Feira
[2025-04-11T19:59:42.372+0000] {logging_mixin.py:188} INFO - üîç Searching for: Fela Kuti
[2025-04-11T19:59:42.814+0000] {logging_mixin.py:188} INFO - üîç Searching for: Tito Puente
[2025-04-11T19:59:43.156+0000] {taskinstance.py:2698} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 433, in _execute_task
    result = execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 199, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 216, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/rag_daily_discovery.py", line 32, in discovery_flow
    results_df = search_many(cleaned_queries)
  File "/opt/airflow/backend/rag_pipeline/search_youtube.py", line 45, in search_many
    vids = search_youtube(query, max_results=max_results)
  File "/opt/airflow/backend/rag_pipeline/search_youtube.py", line 28, in search_youtube
    video_id = item["id"]["videoId"]
KeyError: 'videoId'
[2025-04-11T19:59:43.177+0000] {taskinstance.py:1138} INFO - Marking task as FAILED. dag_id=rag_daily_discovery, task_id=run_discovery_flow, execution_date=20250411T195930, start_date=20250411T195934, end_date=20250411T195943
[2025-04-11T19:59:43.190+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 171 for task run_discovery_flow ('videoId'; 99)
[2025-04-11T19:59:43.238+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2025-04-11T19:59:43.273+0000] {taskinstance.py:3280} INFO - 0 downstream tasks scheduled from follow-on schedule check
