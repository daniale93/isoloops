[2025-04-11T20:05:41.093+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: rag_daily_discovery.run_discovery_flow manual__2025-04-11T20:05:38.318954+00:00 [queued]>
[2025-04-11T20:05:41.098+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: rag_daily_discovery.run_discovery_flow manual__2025-04-11T20:05:38.318954+00:00 [queued]>
[2025-04-11T20:05:41.098+0000] {taskinstance.py:2170} INFO - Starting attempt 1 of 1
[2025-04-11T20:05:41.105+0000] {taskinstance.py:2191} INFO - Executing <Task(PythonOperator): run_discovery_flow> on 2025-04-11 20:05:38.318954+00:00
[2025-04-11T20:05:41.113+0000] {standard_task_runner.py:60} INFO - Started process 107 to run task
[2025-04-11T20:05:41.116+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'rag_daily_discovery', 'run_discovery_flow', 'manual__2025-04-11T20:05:38.318954+00:00', '--job-id', '176', '--raw', '--subdir', 'DAGS_FOLDER/rag_daily_discovery.py', '--cfg-path', '/tmp/tmpuyhwqpoc']
[2025-04-11T20:05:41.117+0000] {standard_task_runner.py:88} INFO - Job 176: Subtask run_discovery_flow
[2025-04-11T20:05:41.170+0000] {task_command.py:423} INFO - Running <TaskInstance: rag_daily_discovery.run_discovery_flow manual__2025-04-11T20:05:38.318954+00:00 [running]> on host ca2379c9c1f8
[2025-04-11T20:05:41.218+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='rag_daily_discovery' AIRFLOW_CTX_TASK_ID='run_discovery_flow' AIRFLOW_CTX_EXECUTION_DATE='2025-04-11T20:05:38.318954+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-04-11T20:05:38.318954+00:00'
[2025-04-11T20:05:51.818+0000] {logging_mixin.py:188} INFO - üîç Raw queries from LLM: ['Here‚Äôs a list of 40 songs and artists known for strong isolated percussion or vocal sections ideal for sampling across Afro, Latin, funk, or world genres:', 'Mongo Santamar√≠a', 'Tito Puente', 'Jorge Ben Jor', 'Rubens Bassini', 'Airto Moreira', 'Fela Kuti', 'Os Mutantes', 'Antonio Carlos Jobim', 'Gilberto Gil', 'Buena Vista Social Club', 'Celia Cruz', 'Les Ambassadeurs', 'Antibalas', 'Bomba Est√©reo', 'Oumou Sangar√©', 'Novalima', 'Tinariwen', "Negroni's Trio", 'Quantic', 'Ricardo Villalobos', 'Manu Dibango', 'Amadou & Mariam', 'Ebo Taylor', 'King Sunny Ad√©', 'Toots and the Maytals', 'The Bhundu Boys', 'Os Afro-Sambas', 'Pato Banton', 'Grupo Fantasma', 'Cumbia All Stars', 'Chembo Corniel', 'Latin Playboys', 'The Meters', 'Femi Kuti', 'La Chiva Gantiva', 'Bassekou Kouyat√©', 'Orchestre Poly-Rythmo', 'Les Fr√®res Guiss√©', 'Ricardo Arjona', 'St Germain', 'This list features a variety of artists and songs that highlight strong percussion and vocal elements suitable for sampling']
[2025-04-11T20:05:51.820+0000] {logging_mixin.py:188} INFO - üîç Searching for: Mongo Santamar√≠a
[2025-04-11T20:05:52.291+0000] {logging_mixin.py:188} INFO - üîç Searching for: Tito Puente
[2025-04-11T20:05:52.675+0000] {logging_mixin.py:188} INFO - ‚ö†Ô∏è Skipping item without videoId: {'kind': 'youtube#searchResult', 'etag': 'CgpjFtFwzbTpvPgsMdcBWnD6f_w', 'id': {'kind': 'youtube#channel', 'channelId': 'UC-80HNiK3Vwd0zcFcfB8hRw'}, 'snippet': {'publishedAt': '2021-10-26T15:06:44Z', 'channelId': 'UC-80HNiK3Vwd0zcFcfB8hRw', 'title': 'Tito Puente', 'description': 'Ernest Anthony "Tito" Puente, Jr. (April 20, 1923 ‚Äì June 1, 2000) was an American musician of Puerto Rican descent, songwriter, ...', 'thumbnails': {'default': {'url': 'https://yt3.ggpht.com/AcaDaLafmIp_Yt1PuhR-Zy3HgJM95v48evOtODt6IR-y1mbHgQmH2Byv7rVFOaG9ZmtfNHUzC0I=s88-c-k-c0xffffffff-no-rj-mo'}, 'medium': {'url': 'https://yt3.ggpht.com/AcaDaLafmIp_Yt1PuhR-Zy3HgJM95v48evOtODt6IR-y1mbHgQmH2Byv7rVFOaG9ZmtfNHUzC0I=s240-c-k-c0xffffffff-no-rj-mo'}, 'high': {'url': 'https://yt3.ggpht.com/AcaDaLafmIp_Yt1PuhR-Zy3HgJM95v48evOtODt6IR-y1mbHgQmH2Byv7rVFOaG9ZmtfNHUzC0I=s800-c-k-c0xffffffff-no-rj-mo'}}, 'channelTitle': 'Tito Puente', 'liveBroadcastContent': 'none', 'publishTime': '2021-10-26T15:06:44Z'}}
[2025-04-11T20:05:52.677+0000] {logging_mixin.py:188} INFO - üîç Searching for: Jorge Ben Jor
[2025-04-11T20:05:53.136+0000] {logging_mixin.py:188} INFO - ‚ö†Ô∏è Skipping item without videoId: {'kind': 'youtube#searchResult', 'etag': '6WJSs-lr_Wk1WiJ966l2GmNYj30', 'id': {'kind': 'youtube#channel', 'channelId': 'UCFpJpUf7dBHx76ebfU3AgNg'}, 'snippet': {'publishedAt': '2015-04-29T17:46:17Z', 'channelId': 'UCFpJpUf7dBHx76ebfU3AgNg', 'title': 'Jorge Ben Jor', 'description': '', 'thumbnails': {'default': {'url': 'https://yt3.ggpht.com/ytc/AIdro_lrbNZbR3Es80wUrUwzHxIcUxS4GGh79cz5bPMgqnfzWw=s88-c-k-c0xffffffff-no-rj-mo'}, 'medium': {'url': 'https://yt3.ggpht.com/ytc/AIdro_lrbNZbR3Es80wUrUwzHxIcUxS4GGh79cz5bPMgqnfzWw=s240-c-k-c0xffffffff-no-rj-mo'}, 'high': {'url': 'https://yt3.ggpht.com/ytc/AIdro_lrbNZbR3Es80wUrUwzHxIcUxS4GGh79cz5bPMgqnfzWw=s800-c-k-c0xffffffff-no-rj-mo'}}, 'channelTitle': 'Jorge Ben Jor', 'liveBroadcastContent': 'none', 'publishTime': '2015-04-29T17:46:17Z'}}
[2025-04-11T20:05:53.139+0000] {logging_mixin.py:188} INFO - üîç Searching for: Rubens Bassini
[2025-04-11T20:05:53.435+0000] {logging_mixin.py:188} INFO - üîç Searching for: Airto Moreira
[2025-04-11T20:05:53.814+0000] {logging_mixin.py:188} INFO - üîç Searching for: Fela Kuti
[2025-04-11T20:05:54.295+0000] {logging_mixin.py:188} INFO - üîç Searching for: Os Mutantes
[2025-04-11T20:05:54.717+0000] {logging_mixin.py:188} INFO - ‚ö†Ô∏è Skipping item without videoId: {'kind': 'youtube#searchResult', 'etag': 'dYFo0lSwoJAINMKLp-cHvL2V6cc', 'id': {'kind': 'youtube#channel', 'channelId': 'UCVfpXhwTkGZL9dzPdZhFQbg'}, 'snippet': {'publishedAt': '2021-12-03T18:18:18Z', 'channelId': 'UCVfpXhwTkGZL9dzPdZhFQbg', 'title': 'Os Mutantes Oficial', 'description': '', 'thumbnails': {'default': {'url': 'https://yt3.ggpht.com/nNlmE7ULUd1nitAZrRdnmFH5ccF1fOvuiUk2qe2eRvvGgnFN1i0YKOEshpIPK_eLNo2v3wja=s88-c-k-c0xffffffff-no-rj-mo'}, 'medium': {'url': 'https://yt3.ggpht.com/nNlmE7ULUd1nitAZrRdnmFH5ccF1fOvuiUk2qe2eRvvGgnFN1i0YKOEshpIPK_eLNo2v3wja=s240-c-k-c0xffffffff-no-rj-mo'}, 'high': {'url': 'https://yt3.ggpht.com/nNlmE7ULUd1nitAZrRdnmFH5ccF1fOvuiUk2qe2eRvvGgnFN1i0YKOEshpIPK_eLNo2v3wja=s800-c-k-c0xffffffff-no-rj-mo'}}, 'channelTitle': 'Os Mutantes Oficial', 'liveBroadcastContent': 'none', 'publishTime': '2021-12-03T18:18:18Z'}}
[2025-04-11T20:05:54.720+0000] {logging_mixin.py:188} INFO - üîç Searching for: Antonio Carlos Jobim
[2025-04-11T20:05:55.214+0000] {logging_mixin.py:188} INFO - ‚ö†Ô∏è Skipping item without videoId: {'kind': 'youtube#searchResult', 'etag': 'JsLxvjx6mIkTcT3aJ-_8qDQF-iY', 'id': {'kind': 'youtube#channel', 'channelId': 'UCzXA5HkGXQ1KkqKd7s8g_MA'}, 'snippet': {'publishedAt': '2020-04-30T19:19:46Z', 'channelId': 'UCzXA5HkGXQ1KkqKd7s8g_MA', 'title': 'Tom Jobim Oficial', 'description': 'Sejam bem-vindos ao canal do Instituto Antonio Carlos Jobim. O IACJ tem como prop√≥sito a conserva√ß√£o da mem√≥ria e a difus√£o ...', 'thumbnails': {'default': {'url': 'https://yt3.ggpht.com/ytc/AIdro_klqwJuhd0KZgYiOx-K1ePjmDEVREf_FKweje8uhsy9QA=s88-c-k-c0xffffffff-no-rj-mo'}, 'medium': {'url': 'https://yt3.ggpht.com/ytc/AIdro_klqwJuhd0KZgYiOx-K1ePjmDEVREf_FKweje8uhsy9QA=s240-c-k-c0xffffffff-no-rj-mo'}, 'high': {'url': 'https://yt3.ggpht.com/ytc/AIdro_klqwJuhd0KZgYiOx-K1ePjmDEVREf_FKweje8uhsy9QA=s800-c-k-c0xffffffff-no-rj-mo'}}, 'channelTitle': 'Tom Jobim Oficial', 'liveBroadcastContent': 'none', 'publishTime': '2020-04-30T19:19:46Z'}}
[2025-04-11T20:05:55.215+0000] {logging_mixin.py:188} INFO - üîç Searching for: Gilberto Gil
[2025-04-11T20:05:55.723+0000] {logging_mixin.py:188} INFO - üîç Searching for: Buena Vista Social Club
[2025-04-11T20:05:56.102+0000] {logging_mixin.py:188} INFO - ‚ö†Ô∏è Skipping item without videoId: {'kind': 'youtube#searchResult', 'etag': 'U1noproemv30MX63vfsPsp1IVfw', 'id': {'kind': 'youtube#channel', 'channelId': 'UCJYl3tOsrTkCCidMjhxdAeQ'}, 'snippet': {'publishedAt': '2021-03-15T14:01:52Z', 'channelId': 'UCJYl3tOsrTkCCidMjhxdAeQ', 'title': 'Buena Vista Social Club', 'description': "'Buena Vista Social Club' is both the name given to this extraordinary group of musicians and the album, recorded in just 1 week ...", 'thumbnails': {'default': {'url': 'https://yt3.ggpht.com/1tPZgN1D6xL31VaRs_hlhROmK6GM_kcZW_hu-K6BNPkND_ir7dUFQjWf8ySn-MIw5r8pw_yi=s88-c-k-c0xffffffff-no-rj-mo'}, 'medium': {'url': 'https://yt3.ggpht.com/1tPZgN1D6xL31VaRs_hlhROmK6GM_kcZW_hu-K6BNPkND_ir7dUFQjWf8ySn-MIw5r8pw_yi=s240-c-k-c0xffffffff-no-rj-mo'}, 'high': {'url': 'https://yt3.ggpht.com/1tPZgN1D6xL31VaRs_hlhROmK6GM_kcZW_hu-K6BNPkND_ir7dUFQjWf8ySn-MIw5r8pw_yi=s800-c-k-c0xffffffff-no-rj-mo'}}, 'channelTitle': 'Buena Vista Social Club', 'liveBroadcastContent': 'none', 'publishTime': '2021-03-15T14:01:52Z'}}
[2025-04-11T20:05:56.110+0000] {logging_mixin.py:188} INFO - üîç Searching for: Celia Cruz
[2025-04-11T20:05:56.482+0000] {logging_mixin.py:188} INFO - üîç Searching for: Les Ambassadeurs
[2025-04-11T20:05:56.854+0000] {logging_mixin.py:188} INFO - üîç Searching for: Antibalas
[2025-04-11T20:05:57.219+0000] {logging_mixin.py:188} INFO - üîç Searching for: Bomba Est√©reo
[2025-04-11T20:05:57.559+0000] {logging_mixin.py:188} INFO - üîç Searching for: Oumou Sangar√©
[2025-04-11T20:05:57.942+0000] {logging_mixin.py:188} INFO - ‚ö†Ô∏è Skipping item without videoId: {'kind': 'youtube#searchResult', 'etag': 'TfNkO7QnEXGY2AtuoJgD8d5htZ4', 'id': {'kind': 'youtube#channel', 'channelId': 'UCdyPkcbix5sQsch8BBoeFBQ'}, 'snippet': {'publishedAt': '2020-01-16T16:22:46Z', 'channelId': 'UCdyPkcbix5sQsch8BBoeFBQ', 'title': 'Oumou Sangar√©', 'description': "The official channel of Mali's great diva Oumou Sangar√© New album 'Timbuktu' out now http://worldcircuit.lnk.to/OSTimbuktu.", 'thumbnails': {'default': {'url': 'https://yt3.ggpht.com/ZXgxr-0-eucn1EUw2_1zXdMHwBmkWwHqqzOptU7T294cBll3FH09wD1IqCWY-tprHsMuv4VSwO8=s88-c-k-c0xffffffff-no-rj-mo'}, 'medium': {'url': 'https://yt3.ggpht.com/ZXgxr-0-eucn1EUw2_1zXdMHwBmkWwHqqzOptU7T294cBll3FH09wD1IqCWY-tprHsMuv4VSwO8=s240-c-k-c0xffffffff-no-rj-mo'}, 'high': {'url': 'https://yt3.ggpht.com/ZXgxr-0-eucn1EUw2_1zXdMHwBmkWwHqqzOptU7T294cBll3FH09wD1IqCWY-tprHsMuv4VSwO8=s800-c-k-c0xffffffff-no-rj-mo'}}, 'channelTitle': 'Oumou Sangar√©', 'liveBroadcastContent': 'none', 'publishTime': '2020-01-16T16:22:46Z'}}
[2025-04-11T20:05:57.947+0000] {logging_mixin.py:188} INFO - üîç Searching for: Novalima
[2025-04-11T20:05:58.044+0000] {taskinstance.py:2698} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 433, in _execute_task
    result = execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 199, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 216, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/rag_daily_discovery.py", line 32, in discovery_flow
    results_df = search_many(cleaned_queries)
  File "/opt/airflow/backend/rag_pipeline/search_youtube.py", line 42, in search_many
    vids = search_youtube(query, max_results=max_results)
  File "/opt/airflow/backend/rag_pipeline/search_youtube.py", line 24, in search_youtube
    res.raise_for_status()
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/models.py", line 1021, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 403 Client Error: Forbidden for url: https://www.googleapis.com/youtube/v3/search?part=snippet&q=Novalima&type=video&videoEmbeddable=true&maxResults=3&key=AIzaSyDXVgYFXmb1izn5fVKfL7O28rQYh28eMIs
[2025-04-11T20:05:58.066+0000] {taskinstance.py:1138} INFO - Marking task as FAILED. dag_id=rag_daily_discovery, task_id=run_discovery_flow, execution_date=20250411T200538, start_date=20250411T200541, end_date=20250411T200558
[2025-04-11T20:05:58.097+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 176 for task run_discovery_flow (403 Client Error: Forbidden for url: https://www.googleapis.com/youtube/v3/search?part=snippet&q=Novalima&type=video&videoEmbeddable=true&maxResults=3&key=AIzaSyDXVgYFXmb1izn5fVKfL7O28rQYh28eMIs; 107)
[2025-04-11T20:05:58.155+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2025-04-11T20:05:58.175+0000] {taskinstance.py:3280} INFO - 0 downstream tasks scheduled from follow-on schedule check
