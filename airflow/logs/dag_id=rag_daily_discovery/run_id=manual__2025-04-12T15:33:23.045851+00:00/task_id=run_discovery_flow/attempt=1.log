[2025-04-12T15:33:26.064+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: rag_daily_discovery.run_discovery_flow manual__2025-04-12T15:33:23.045851+00:00 [queued]>
[2025-04-12T15:33:26.069+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: rag_daily_discovery.run_discovery_flow manual__2025-04-12T15:33:23.045851+00:00 [queued]>
[2025-04-12T15:33:26.070+0000] {taskinstance.py:2170} INFO - Starting attempt 1 of 1
[2025-04-12T15:33:26.078+0000] {taskinstance.py:2191} INFO - Executing <Task(PythonOperator): run_discovery_flow> on 2025-04-12 15:33:23.045851+00:00
[2025-04-12T15:33:26.088+0000] {standard_task_runner.py:60} INFO - Started process 17171 to run task
[2025-04-12T15:33:26.103+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'rag_daily_discovery', 'run_discovery_flow', 'manual__2025-04-12T15:33:23.045851+00:00', '--job-id', '179', '--raw', '--subdir', 'DAGS_FOLDER/rag_daily_discovery.py', '--cfg-path', '/tmp/tmpy00abg54']
[2025-04-12T15:33:26.110+0000] {standard_task_runner.py:88} INFO - Job 179: Subtask run_discovery_flow
[2025-04-12T15:33:26.208+0000] {task_command.py:423} INFO - Running <TaskInstance: rag_daily_discovery.run_discovery_flow manual__2025-04-12T15:33:23.045851+00:00 [running]> on host ca2379c9c1f8
[2025-04-12T15:33:26.283+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='rag_daily_discovery' AIRFLOW_CTX_TASK_ID='run_discovery_flow' AIRFLOW_CTX_EXECUTION_DATE='2025-04-12T15:33:23.045851+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-04-12T15:33:23.045851+00:00'
[2025-04-12T15:33:31.720+0000] {logging_mixin.py:188} INFO - üîç Raw queries from LLM: ["Sure! Here's a list of 40 songs or artists known for their strong isolated percussion or vocal sections, ideal for sampling:", 'Mongo Santamaria', 'Rubens Bassini', 'Quinta Feira', 'Fela Kuti', 'Tito Puente', 'Baden Powell', 'Lila Downs', 'Os Mutantes', 'Mulatu Astatke', 'Antibalas', 'Bebel Gilberto', 'Les Ambassadeurs', 'Celia Cruz', 'Afrobeat Academy', 'Jorge Ben Jor', 'Amadou & Mariam', 'Oumou Sangar√©', 'Grupo Fantasma', 'Bo Kaspers Orkester', 'Tinariwen', 'Novalima', 'Caetano Veloso', 'Gilberto Gil', 'Celso Fonseca', 'Konono No', 'The Budos Band', 'The Social Club', 'Sona Jobarteh', 'Ali Farka Tour√©', 'The Very Best', 'ChocQuibTown', 'Gato Barbieri', 'Bonga', 'Los Van Van', 'Sepultura (for percussion-focused tracks)', 'Orchestra Baobab', 'Shconguito', 'Sidi Tour√©', 'Toots and The Maytals', 'La Chiva Gantiva', 'Feel free to explore their discographies for standout tracks that fit your sampling needs!']
[2025-04-12T15:33:31.722+0000] {logging_mixin.py:188} INFO - üìä Processing 5 YouTube queries (max_results=3)
[2025-04-12T15:33:31.722+0000] {logging_mixin.py:188} INFO - [1/5] üîç Searching: Mongo Santamaria
[2025-04-12T15:33:32.179+0000] {logging_mixin.py:188} INFO - [2/5] üîç Searching: Rubens Bassini
[2025-04-12T15:33:32.716+0000] {logging_mixin.py:188} INFO - [3/5] üîç Searching: Quinta Feira
[2025-04-12T15:33:33.200+0000] {logging_mixin.py:188} INFO - [4/5] üîç Searching: Fela Kuti
[2025-04-12T15:33:33.678+0000] {logging_mixin.py:188} INFO - [5/5] üîç Searching: Tito Puente
[2025-04-12T15:33:34.108+0000] {logging_mixin.py:188} INFO - ‚ö†Ô∏è Skipping item without videoId: {'kind': 'youtube#searchResult', 'etag': 'LovPuCkMNVkVpIFS5QR7JDuTxLc', 'id': {'kind': 'youtube#channel', 'channelId': 'UC-80HNiK3Vwd0zcFcfB8hRw'}, 'snippet': {'publishedAt': '2021-10-26T15:06:44Z', 'channelId': 'UC-80HNiK3Vwd0zcFcfB8hRw', 'title': 'Tito Puente', 'description': 'Ernest Anthony "Tito" Puente, Jr. (April 20, 1923 ‚Äì June 1, 2000) was an American musician of Puerto Rican descent, songwriter, ...', 'thumbnails': {'default': {'url': 'https://yt3.ggpht.com/AcaDaLafmIp_Yt1PuhR-Zy3HgJM95v48evOtODt6IR-y1mbHgQmH2Byv7rVFOaG9ZmtfNHUzC0I=s88-c-k-c0xffffffff-no-rj-mo'}, 'medium': {'url': 'https://yt3.ggpht.com/AcaDaLafmIp_Yt1PuhR-Zy3HgJM95v48evOtODt6IR-y1mbHgQmH2Byv7rVFOaG9ZmtfNHUzC0I=s240-c-k-c0xffffffff-no-rj-mo'}, 'high': {'url': 'https://yt3.ggpht.com/AcaDaLafmIp_Yt1PuhR-Zy3HgJM95v48evOtODt6IR-y1mbHgQmH2Byv7rVFOaG9ZmtfNHUzC0I=s800-c-k-c0xffffffff-no-rj-mo'}}, 'channelTitle': 'Tito Puente', 'liveBroadcastContent': 'none', 'publishTime': '2021-10-26T15:06:44Z'}}
[2025-04-12T15:33:34.130+0000] {logging_mixin.py:188} INFO - ‚úÖ Total videos retrieved: 14
[2025-04-12T15:33:34.131+0000] {connection.py:370} INFO - Snowflake Connector for Python Version: 3.6.0, Python Version: 3.8.18, Platform: Linux-6.12.5-linuxkit-aarch64-with-glibc2.34
[2025-04-12T15:33:34.133+0000] {connection.py:1171} INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
[2025-04-12T15:33:34.723+0000] {cursor.py:1028} INFO - query: [CREATE TABLE IF NOT EXISTS DISCOVERED_SONGS ( title STRING, youtube_url STRING, ...]
[2025-04-12T15:33:34.900+0000] {cursor.py:1041} INFO - query execution done
[2025-04-12T15:33:34.902+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2025-04-12T15:33:34.903+0000] {cursor.py:1028} INFO - query: [SELECT youtube_url FROM DISCOVERED_SONGS]
[2025-04-12T15:33:35.025+0000] {cursor.py:1041} INFO - query execution done
[2025-04-12T15:33:35.057+0000] {cursor.py:1205} INFO - Number of results in first chunk: 0
[2025-04-12T15:33:35.103+0000] {cursor.py:1028} INFO - query: [INSERT INTO DISCOVERED_SONGS ( title, youtube_url, start_time, end_time, sample_...]
[2025-04-12T15:33:35.492+0000] {cursor.py:1041} INFO - query execution done
[2025-04-12T15:33:35.494+0000] {cursor.py:1028} INFO - query: [INSERT INTO DISCOVERED_SONGS ( title, youtube_url, start_time, end_time, sample_...]
[2025-04-12T15:33:35.904+0000] {cursor.py:1041} INFO - query execution done
[2025-04-12T15:33:35.907+0000] {cursor.py:1028} INFO - query: [INSERT INTO DISCOVERED_SONGS ( title, youtube_url, start_time, end_time, sample_...]
[2025-04-12T15:33:36.296+0000] {cursor.py:1041} INFO - query execution done
[2025-04-12T15:33:36.304+0000] {cursor.py:1028} INFO - query: [INSERT INTO DISCOVERED_SONGS ( title, youtube_url, start_time, end_time, sample_...]
[2025-04-12T15:33:36.716+0000] {cursor.py:1041} INFO - query execution done
[2025-04-12T15:33:36.720+0000] {cursor.py:1028} INFO - query: [INSERT INTO DISCOVERED_SONGS ( title, youtube_url, start_time, end_time, sample_...]
[2025-04-12T15:33:37.125+0000] {cursor.py:1041} INFO - query execution done
[2025-04-12T15:33:37.126+0000] {cursor.py:1028} INFO - query: [INSERT INTO DISCOVERED_SONGS ( title, youtube_url, start_time, end_time, sample_...]
[2025-04-12T15:33:37.512+0000] {cursor.py:1041} INFO - query execution done
[2025-04-12T15:33:37.516+0000] {cursor.py:1028} INFO - query: [INSERT INTO DISCOVERED_SONGS ( title, youtube_url, start_time, end_time, sample_...]
[2025-04-12T15:33:37.880+0000] {cursor.py:1041} INFO - query execution done
[2025-04-12T15:33:37.881+0000] {cursor.py:1028} INFO - query: [INSERT INTO DISCOVERED_SONGS ( title, youtube_url, start_time, end_time, sample_...]
[2025-04-12T15:33:38.303+0000] {cursor.py:1041} INFO - query execution done
[2025-04-12T15:33:38.304+0000] {cursor.py:1028} INFO - query: [INSERT INTO DISCOVERED_SONGS ( title, youtube_url, start_time, end_time, sample_...]
[2025-04-12T15:33:38.616+0000] {cursor.py:1041} INFO - query execution done
[2025-04-12T15:33:38.617+0000] {cursor.py:1028} INFO - query: [INSERT INTO DISCOVERED_SONGS ( title, youtube_url, start_time, end_time, sample_...]
[2025-04-12T15:33:38.999+0000] {cursor.py:1041} INFO - query execution done
[2025-04-12T15:33:39.001+0000] {cursor.py:1028} INFO - query: [INSERT INTO DISCOVERED_SONGS ( title, youtube_url, start_time, end_time, sample_...]
[2025-04-12T15:33:39.334+0000] {cursor.py:1041} INFO - query execution done
[2025-04-12T15:33:39.335+0000] {cursor.py:1028} INFO - query: [INSERT INTO DISCOVERED_SONGS ( title, youtube_url, start_time, end_time, sample_...]
[2025-04-12T15:33:39.674+0000] {cursor.py:1041} INFO - query execution done
[2025-04-12T15:33:39.678+0000] {cursor.py:1028} INFO - query: [INSERT INTO DISCOVERED_SONGS ( title, youtube_url, start_time, end_time, sample_...]
[2025-04-12T15:33:40.062+0000] {cursor.py:1041} INFO - query execution done
[2025-04-12T15:33:40.069+0000] {cursor.py:1028} INFO - query: [INSERT INTO DISCOVERED_SONGS ( title, youtube_url, start_time, end_time, sample_...]
[2025-04-12T15:33:40.461+0000] {cursor.py:1041} INFO - query execution done
[2025-04-12T15:33:40.462+0000] {cursor.py:1028} INFO - query: [COMMIT]
[2025-04-12T15:33:40.533+0000] {cursor.py:1041} INFO - query execution done
[2025-04-12T15:33:40.533+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2025-04-12T15:33:40.534+0000] {logging_mixin.py:188} INFO - ‚úÖ Loaded 14 new rows to DISCOVERED_SONGS.
[2025-04-12T15:33:40.534+0000] {connection.py:718} INFO - closed
[2025-04-12T15:33:40.647+0000] {connection.py:724} INFO - No async queries seem to be running, deleting session
[2025-04-12T15:33:40.698+0000] {python.py:201} INFO - Done. Returned value was: None
[2025-04-12T15:33:40.733+0000] {taskinstance.py:1138} INFO - Marking task as SUCCESS. dag_id=rag_daily_discovery, task_id=run_discovery_flow, execution_date=20250412T153323, start_date=20250412T153326, end_date=20250412T153340
[2025-04-12T15:33:40.809+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 0
[2025-04-12T15:33:40.860+0000] {taskinstance.py:3280} INFO - 0 downstream tasks scheduled from follow-on schedule check
