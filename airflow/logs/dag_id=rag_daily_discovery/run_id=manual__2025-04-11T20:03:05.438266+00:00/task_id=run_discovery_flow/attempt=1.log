[2025-04-11T20:03:07.972+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: rag_daily_discovery.run_discovery_flow manual__2025-04-11T20:03:05.438266+00:00 [queued]>
[2025-04-11T20:03:07.978+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: rag_daily_discovery.run_discovery_flow manual__2025-04-11T20:03:05.438266+00:00 [queued]>
[2025-04-11T20:03:07.979+0000] {taskinstance.py:2170} INFO - Starting attempt 1 of 1
[2025-04-11T20:03:07.987+0000] {taskinstance.py:2191} INFO - Executing <Task(PythonOperator): run_discovery_flow> on 2025-04-11 20:03:05.438266+00:00
[2025-04-11T20:03:07.993+0000] {standard_task_runner.py:60} INFO - Started process 161 to run task
[2025-04-11T20:03:07.996+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'rag_daily_discovery', 'run_discovery_flow', 'manual__2025-04-11T20:03:05.438266+00:00', '--job-id', '173', '--raw', '--subdir', 'DAGS_FOLDER/rag_daily_discovery.py', '--cfg-path', '/tmp/tmpxnhcuiiu']
[2025-04-11T20:03:07.997+0000] {standard_task_runner.py:88} INFO - Job 173: Subtask run_discovery_flow
[2025-04-11T20:03:08.031+0000] {task_command.py:423} INFO - Running <TaskInstance: rag_daily_discovery.run_discovery_flow manual__2025-04-11T20:03:05.438266+00:00 [running]> on host 9c72e9db4421
[2025-04-11T20:03:08.076+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='rag_daily_discovery' AIRFLOW_CTX_TASK_ID='run_discovery_flow' AIRFLOW_CTX_EXECUTION_DATE='2025-04-11T20:03:05.438266+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-04-11T20:03:05.438266+00:00'
[2025-04-11T20:03:14.555+0000] {logging_mixin.py:188} INFO - üîç Raw queries from LLM: ['Sure! Here‚Äôs a list of 40 songs or artists known for strong isolated percussion or vocal sections ideal for sampling, across Afro, Latin, funk, or world genres:', 'Mongo Santamaria', 'Tito Puente', 'Rubens Bassini', 'Fela Kuti', 'Malinke Drumming (Various Artists)', 'Os Mutantes', 'Airto Moreira', 'Batida', 'Quinta Feira', 'Tony Allen', 'Amadou & Mariam', 'King Sunny Ad√©', 'Bomba Est√©reo', 'Celia Cruz', 'Buena Vista Social Club', 'Getz/Gilberto (Stan Getz & Jo√£o Gilberto)', "Les Amazones d'Afrique", 'Antibalas', 'The Budos Band', 'Novalima', 'Tortoise', "Pierre Moerlen's Gong", 'Xmal Deutschland', 'Konono N¬∫', 'Orkesta Mendoza', 'Grupo Fantasma', 'Oumou Sangar√©', 'Hugh Masekela', 'Los Van Van', 'Ebo Taylor', 'Tinariwen', "Youssou N'Dour", 'La Yegros', 'Bassekou Kouyat√©', 'Rokia Traor√©', 'Mokoomba', 'Lila Downs', 'Afro-Cuban All Stars', 'Dudu Tassa', 'Shakira (early works)', 'Feel free to explore these artists and their works for rich percussion and vocal elements!']
[2025-04-11T20:03:14.556+0000] {logging_mixin.py:188} INFO - üîç Searching for: Mongo Santamaria
[2025-04-11T20:03:14.982+0000] {logging_mixin.py:188} INFO - üîç Searching for: Tito Puente
[2025-04-11T20:03:15.478+0000] {logging_mixin.py:188} INFO - üîç Searching for: Rubens Bassini
[2025-04-11T20:03:15.936+0000] {logging_mixin.py:188} INFO - üîç Searching for: Fela Kuti
[2025-04-11T20:03:16.428+0000] {logging_mixin.py:188} INFO - üîç Searching for: Malinke Drumming (Various Artists)
[2025-04-11T20:03:16.841+0000] {logging_mixin.py:188} INFO - üîç Searching for: Os Mutantes
[2025-04-11T20:03:17.243+0000] {logging_mixin.py:188} INFO - üîç Searching for: Airto Moreira
[2025-04-11T20:03:17.610+0000] {logging_mixin.py:188} INFO - üîç Searching for: Batida
[2025-04-11T20:03:18.065+0000] {logging_mixin.py:188} INFO - üîç Searching for: Quinta Feira
[2025-04-11T20:03:18.602+0000] {logging_mixin.py:188} INFO - üîç Searching for: Tony Allen
[2025-04-11T20:03:18.991+0000] {logging_mixin.py:188} INFO - üîç Searching for: Amadou & Mariam
[2025-04-11T20:03:19.420+0000] {logging_mixin.py:188} INFO - üîç Searching for: King Sunny Ad√©
[2025-04-11T20:03:19.872+0000] {logging_mixin.py:188} INFO - üîç Searching for: Bomba Est√©reo
[2025-04-11T20:03:20.219+0000] {logging_mixin.py:188} INFO - üîç Searching for: Celia Cruz
[2025-04-11T20:03:20.665+0000] {logging_mixin.py:188} INFO - üîç Searching for: Buena Vista Social Club
[2025-04-11T20:03:21.128+0000] {logging_mixin.py:188} INFO - ‚ö†Ô∏è Skipping item without videoId: {'kind': 'youtube#searchResult', 'etag': 'U1noproemv30MX63vfsPsp1IVfw', 'id': {'kind': 'youtube#channel', 'channelId': 'UCJYl3tOsrTkCCidMjhxdAeQ'}, 'snippet': {'publishedAt': '2021-03-15T14:01:52Z', 'channelId': 'UCJYl3tOsrTkCCidMjhxdAeQ', 'title': 'Buena Vista Social Club', 'description': "'Buena Vista Social Club' is both the name given to this extraordinary group of musicians and the album, recorded in just 1 week ...", 'thumbnails': {'default': {'url': 'https://yt3.ggpht.com/1tPZgN1D6xL31VaRs_hlhROmK6GM_kcZW_hu-K6BNPkND_ir7dUFQjWf8ySn-MIw5r8pw_yi=s88-c-k-c0xffffffff-no-rj-mo'}, 'medium': {'url': 'https://yt3.ggpht.com/1tPZgN1D6xL31VaRs_hlhROmK6GM_kcZW_hu-K6BNPkND_ir7dUFQjWf8ySn-MIw5r8pw_yi=s240-c-k-c0xffffffff-no-rj-mo'}, 'high': {'url': 'https://yt3.ggpht.com/1tPZgN1D6xL31VaRs_hlhROmK6GM_kcZW_hu-K6BNPkND_ir7dUFQjWf8ySn-MIw5r8pw_yi=s800-c-k-c0xffffffff-no-rj-mo'}}, 'channelTitle': 'Buena Vista Social Club', 'liveBroadcastContent': 'none', 'publishTime': '2021-03-15T14:01:52Z'}}
[2025-04-11T20:03:21.131+0000] {logging_mixin.py:188} INFO - üîç Searching for: Getz/Gilberto (Stan Getz & Jo√£o Gilberto)
[2025-04-11T20:03:21.657+0000] {logging_mixin.py:188} INFO - üîç Searching for: Les Amazones d'Afrique
[2025-04-11T20:03:22.055+0000] {logging_mixin.py:188} INFO - üîç Searching for: Antibalas
[2025-04-11T20:03:22.497+0000] {logging_mixin.py:188} INFO - üîç Searching for: The Budos Band
[2025-04-11T20:03:22.941+0000] {logging_mixin.py:188} INFO - ‚ö†Ô∏è Skipping item without videoId: {'kind': 'youtube#searchResult', 'etag': 'KcGXAov7-7uuhRXIVdDFKWigFZA', 'id': {'kind': 'youtube#channel', 'channelId': 'UCvQgxMD5WBq3JfJLHQkpcKA'}, 'snippet': {'publishedAt': '2013-09-18T03:16:16Z', 'channelId': 'UCvQgxMD5WBq3JfJLHQkpcKA', 'title': 'The Budos Band - Topic', 'description': '', 'thumbnails': {'default': {'url': 'https://yt3.ggpht.com/SpJg1qf_qjWYRhE-IfDaZQ9p695bCq7D54x29SK5XjEjp8JxiQ0nJJrUQG5ijKG9t9Gwz8LH=s88-c-k-c0xffffffff-no-rj-mo'}, 'medium': {'url': 'https://yt3.ggpht.com/SpJg1qf_qjWYRhE-IfDaZQ9p695bCq7D54x29SK5XjEjp8JxiQ0nJJrUQG5ijKG9t9Gwz8LH=s240-c-k-c0xffffffff-no-rj-mo'}, 'high': {'url': 'https://yt3.ggpht.com/SpJg1qf_qjWYRhE-IfDaZQ9p695bCq7D54x29SK5XjEjp8JxiQ0nJJrUQG5ijKG9t9Gwz8LH=s800-c-k-c0xffffffff-no-rj-mo'}}, 'channelTitle': 'The Budos Band - Topic', 'liveBroadcastContent': 'none', 'publishTime': '2013-09-18T03:16:16Z'}}
[2025-04-11T20:03:22.944+0000] {logging_mixin.py:188} INFO - üîç Searching for: Novalima
[2025-04-11T20:03:23.351+0000] {logging_mixin.py:188} INFO - üîç Searching for: Tortoise
[2025-04-11T20:03:23.728+0000] {logging_mixin.py:188} INFO - üîç Searching for: Pierre Moerlen's Gong
[2025-04-11T20:03:24.132+0000] {logging_mixin.py:188} INFO - üîç Searching for: Xmal Deutschland
[2025-04-11T20:03:24.581+0000] {logging_mixin.py:188} INFO - üîç Searching for: Konono N¬∫
[2025-04-11T20:03:25.087+0000] {logging_mixin.py:188} INFO - üîç Searching for: Orkesta Mendoza
[2025-04-11T20:03:25.502+0000] {logging_mixin.py:188} INFO - üîç Searching for: Grupo Fantasma
[2025-04-11T20:03:26.019+0000] {logging_mixin.py:188} INFO - üîç Searching for: Oumou Sangar√©
[2025-04-11T20:03:26.454+0000] {logging_mixin.py:188} INFO - ‚ö†Ô∏è Skipping item without videoId: {'kind': 'youtube#searchResult', 'etag': 'TfNkO7QnEXGY2AtuoJgD8d5htZ4', 'id': {'kind': 'youtube#channel', 'channelId': 'UCdyPkcbix5sQsch8BBoeFBQ'}, 'snippet': {'publishedAt': '2020-01-16T16:22:46Z', 'channelId': 'UCdyPkcbix5sQsch8BBoeFBQ', 'title': 'Oumou Sangar√©', 'description': "The official channel of Mali's great diva Oumou Sangar√© New album 'Timbuktu' out now http://worldcircuit.lnk.to/OSTimbuktu.", 'thumbnails': {'default': {'url': 'https://yt3.ggpht.com/ZXgxr-0-eucn1EUw2_1zXdMHwBmkWwHqqzOptU7T294cBll3FH09wD1IqCWY-tprHsMuv4VSwO8=s88-c-k-c0xffffffff-no-rj-mo'}, 'medium': {'url': 'https://yt3.ggpht.com/ZXgxr-0-eucn1EUw2_1zXdMHwBmkWwHqqzOptU7T294cBll3FH09wD1IqCWY-tprHsMuv4VSwO8=s240-c-k-c0xffffffff-no-rj-mo'}, 'high': {'url': 'https://yt3.ggpht.com/ZXgxr-0-eucn1EUw2_1zXdMHwBmkWwHqqzOptU7T294cBll3FH09wD1IqCWY-tprHsMuv4VSwO8=s800-c-k-c0xffffffff-no-rj-mo'}}, 'channelTitle': 'Oumou Sangar√©', 'liveBroadcastContent': 'none', 'publishTime': '2020-01-16T16:22:46Z'}}
[2025-04-11T20:03:26.456+0000] {logging_mixin.py:188} INFO - üîç Searching for: Hugh Masekela
[2025-04-11T20:03:26.933+0000] {logging_mixin.py:188} INFO - üîç Searching for: Los Van Van
[2025-04-11T20:03:27.383+0000] {logging_mixin.py:188} INFO - ‚ö†Ô∏è Skipping item without videoId: {'kind': 'youtube#searchResult', 'etag': 'aMHnt1svxOtlTzTTK8EpW7L1Yjc', 'id': {'kind': 'youtube#channel', 'channelId': 'UCxyGF46Dlp2g93w5yWCB12Q'}, 'snippet': {'publishedAt': '2017-10-20T01:29:23Z', 'channelId': 'UCxyGF46Dlp2g93w5yWCB12Q', 'title': 'Los Van Van', 'description': 'Los Van Van es una orquesta cubana fundada el 4 de diciembre de 1969 por el bajista Juan Formell. Se trata de una legendaria ...', 'thumbnails': {'default': {'url': 'https://yt3.ggpht.com/mpmYpsK6e0fHIxhIBtiAjej-h5xRZoURi7FnHn3EPMvHL-CpETOX7cvBt9GPw5J0XHQddbEPO2g=s88-c-k-c0xffffffff-no-rj-mo'}, 'medium': {'url': 'https://yt3.ggpht.com/mpmYpsK6e0fHIxhIBtiAjej-h5xRZoURi7FnHn3EPMvHL-CpETOX7cvBt9GPw5J0XHQddbEPO2g=s240-c-k-c0xffffffff-no-rj-mo'}, 'high': {'url': 'https://yt3.ggpht.com/mpmYpsK6e0fHIxhIBtiAjej-h5xRZoURi7FnHn3EPMvHL-CpETOX7cvBt9GPw5J0XHQddbEPO2g=s800-c-k-c0xffffffff-no-rj-mo'}}, 'channelTitle': 'Los Van Van', 'liveBroadcastContent': 'none', 'publishTime': '2017-10-20T01:29:23Z'}}
[2025-04-11T20:03:27.384+0000] {logging_mixin.py:188} INFO - üîç Searching for: Ebo Taylor
[2025-04-11T20:03:27.713+0000] {logging_mixin.py:188} INFO - üîç Searching for: Tinariwen
[2025-04-11T20:03:28.167+0000] {logging_mixin.py:188} INFO - üîç Searching for: Youssou N'Dour
[2025-04-11T20:03:28.678+0000] {logging_mixin.py:188} INFO - üîç Searching for: La Yegros
[2025-04-11T20:03:29.084+0000] {logging_mixin.py:188} INFO - üîç Searching for: Bassekou Kouyat√©
[2025-04-11T20:03:29.553+0000] {logging_mixin.py:188} INFO - üîç Searching for: Rokia Traor√©
[2025-04-11T20:03:29.949+0000] {logging_mixin.py:188} INFO - üîç Searching for: Mokoomba
[2025-04-11T20:03:30.336+0000] {logging_mixin.py:188} INFO - üîç Searching for: Lila Downs
[2025-04-11T20:03:30.728+0000] {logging_mixin.py:188} INFO - üîç Searching for: Afro-Cuban All Stars
[2025-04-11T20:03:31.139+0000] {logging_mixin.py:188} INFO - üîç Searching for: Dudu Tassa
[2025-04-11T20:03:31.602+0000] {logging_mixin.py:188} INFO - üîç Searching for: Shakira (early works)
[2025-04-11T20:03:32.104+0000] {connection.py:370} INFO - Snowflake Connector for Python Version: 3.6.0, Python Version: 3.8.18, Platform: Linux-6.12.5-linuxkit-aarch64-with-glibc2.34
[2025-04-11T20:03:32.131+0000] {taskinstance.py:2698} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 433, in _execute_task
    result = execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 199, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 216, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/rag_daily_discovery.py", line 33, in discovery_flow
    load_to_snowflake(results_df)
  File "/opt/airflow/backend/rag_pipeline/load_to_snowflake.py", line 15, in load_to_snowflake
    conn = snowflake.connector.connect(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/__init__.py", line 54, in Connect
    return SnowflakeConnection(**kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 413, in __init__
    self.connect(**kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 667, in connect
    self.__config(**kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 1120, in __config
    Error.errorhandler_wrapper(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/errors.py", line 290, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/errors.py", line 348, in hand_to_other_handler
    connection.errorhandler(connection, cursor, error_class, error_value)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/errors.py", line 221, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 251005: 251005: User is empty
[2025-04-11T20:03:32.145+0000] {taskinstance.py:1138} INFO - Marking task as FAILED. dag_id=rag_daily_discovery, task_id=run_discovery_flow, execution_date=20250411T200305, start_date=20250411T200307, end_date=20250411T200332
[2025-04-11T20:03:32.161+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 173 for task run_discovery_flow (251005: 251005: User is empty; 161)
[2025-04-11T20:03:32.218+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2025-04-11T20:03:32.240+0000] {taskinstance.py:3280} INFO - 0 downstream tasks scheduled from follow-on schedule check
