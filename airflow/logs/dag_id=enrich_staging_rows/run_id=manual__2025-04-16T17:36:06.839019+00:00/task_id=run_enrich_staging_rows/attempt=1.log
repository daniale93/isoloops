[2025-04-16T17:36:10.324+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: enrich_staging_rows.run_enrich_staging_rows manual__2025-04-16T17:36:06.839019+00:00 [queued]>
[2025-04-16T17:36:10.329+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: enrich_staging_rows.run_enrich_staging_rows manual__2025-04-16T17:36:06.839019+00:00 [queued]>
[2025-04-16T17:36:10.329+0000] {taskinstance.py:2170} INFO - Starting attempt 1 of 2
[2025-04-16T17:36:10.336+0000] {taskinstance.py:2191} INFO - Executing <Task(PythonOperator): run_enrich_staging_rows> on 2025-04-16 17:36:06.839019+00:00
[2025-04-16T17:36:10.347+0000] {standard_task_runner.py:60} INFO - Started process 39231 to run task
[2025-04-16T17:36:10.349+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'enrich_staging_rows', 'run_enrich_staging_rows', 'manual__2025-04-16T17:36:06.839019+00:00', '--job-id', '270', '--raw', '--subdir', 'DAGS_FOLDER/enrich_staging_rows_dag.py', '--cfg-path', '/tmp/tmpn_ezzdvh']
[2025-04-16T17:36:10.350+0000] {standard_task_runner.py:88} INFO - Job 270: Subtask run_enrich_staging_rows
[2025-04-16T17:36:10.386+0000] {task_command.py:423} INFO - Running <TaskInstance: enrich_staging_rows.run_enrich_staging_rows manual__2025-04-16T17:36:06.839019+00:00 [running]> on host d8146153ddc3
[2025-04-16T17:36:10.428+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='enrich_staging_rows' AIRFLOW_CTX_TASK_ID='run_enrich_staging_rows' AIRFLOW_CTX_EXECUTION_DATE='2025-04-16T17:36:06.839019+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-04-16T17:36:06.839019+00:00'
[2025-04-16T17:36:10.430+0000] {connection.py:370} INFO - Snowflake Connector for Python Version: 3.6.0, Python Version: 3.8.18, Platform: Linux-6.12.5-linuxkit-aarch64-with-glibc2.34
[2025-04-16T17:36:10.432+0000] {connection.py:1171} INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
[2025-04-16T17:36:11.188+0000] {cursor.py:1028} INFO - query: [SELECT * FROM SAMPLED_SONGS_STAGING WHERE artist IS NULL OR genre IS NULL]
[2025-04-16T17:36:11.406+0000] {cursor.py:1041} INFO - query execution done
[2025-04-16T17:36:11.407+0000] {cursor.py:1205} INFO - Number of results in first chunk: 4
[2025-04-16T17:36:13.709+0000] {logging_mixin.py:188} INFO - üîç LLM raw response: ```json
{
  "artist": "Esperanza Spalding",
  "genre": "Jazz",
  "description": "This live performance likely features intricate bass lines, smooth vocals, and improvisational elements, making it useful for sampling unique live instrumental sections and vocal phrases.",
  "decade": "2000s",
  "sample_type": "live performance"
}
```
[2025-04-16T17:36:13.711+0000] {cursor.py:1028} INFO - query: [UPDATE SAMPLED_SONGS_STAGING SET artist = 'Esperanza Spalding', genre = 'Jazz', ...]
[2025-04-16T17:36:14.791+0000] {cursor.py:1041} INFO - query execution done
[2025-04-16T17:36:18.426+0000] {logging_mixin.py:188} INFO - üîç LLM raw response: ```json
{
  "artist": "Rodrigo y Gabriela",
  "genre": "World Music",
  "description": "The video likely features an acoustic guitar performance by the duo known for their rhythmic guitar work, which can be useful for sampling instrumental sections, especially for creating unique textures or adding an acoustic feel to a track.",
  "decade": "2000s",
  "sample_type": "instrumental section"
}
```
[2025-04-16T17:36:18.436+0000] {cursor.py:1028} INFO - query: [UPDATE SAMPLED_SONGS_STAGING SET artist = 'Rodrigo y Gabriela', genre = 'World M...]
[2025-04-16T17:36:18.994+0000] {cursor.py:1041} INFO - query execution done
[2025-04-16T17:36:23.125+0000] {logging_mixin.py:188} INFO - üîç LLM raw response: ```json
{
  "artist": "Kiran Ahluwalia with Tinariwen",
  "genre": "World Music",
  "description": "This video likely features a collaboration between Kiran Ahluwalia, known for her expertise in Indian and Pakistani music styles, and Tinariwen, a group renowned for their Tuareg desert blues. The fusion of these styles offers rich, diverse soundscapes suitable for sampling ambient textures, unique vocal harmonies, and intricate instrumental patterns.",
  "decade": "2010s",
  "sample_type": "live performance"
}
```
[2025-04-16T17:36:23.129+0000] {cursor.py:1028} INFO - query: [UPDATE SAMPLED_SONGS_STAGING SET artist = 'Kiran Ahluwalia with Tinariwen', genr...]
[2025-04-16T17:36:23.704+0000] {cursor.py:1041} INFO - query execution done
[2025-04-16T17:36:27.279+0000] {logging_mixin.py:188} INFO - üîç LLM raw response: ```json
{
  "artist": "Rhiannon Giddens",
  "genre": "Folk",
  "description": "This video likely features a soulful rendition of a traditional folk song, with strong vocal performance and acoustic instrumentation, offering rich sampling potential for vocals and instrumental sections.",
  "decade": "2010s",
  "sample_type": "isolated vocals"
}
```
[2025-04-16T17:36:27.288+0000] {cursor.py:1028} INFO - query: [UPDATE SAMPLED_SONGS_STAGING SET artist = 'Rhiannon Giddens', genre = 'Folk', de...]
[2025-04-16T17:36:28.311+0000] {cursor.py:1041} INFO - query execution done
[2025-04-16T17:36:29.817+0000] {cursor.py:1028} INFO - query: [COMMIT]
[2025-04-16T17:36:30.097+0000] {cursor.py:1041} INFO - query execution done
[2025-04-16T17:36:30.098+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2025-04-16T17:36:30.099+0000] {connection.py:718} INFO - closed
[2025-04-16T17:36:30.157+0000] {connection.py:724} INFO - No async queries seem to be running, deleting session
[2025-04-16T17:36:30.220+0000] {logging_mixin.py:188} INFO - ‚úÖ Enriched 4 rows in Snowflake.
[2025-04-16T17:36:30.222+0000] {python.py:201} INFO - Done. Returned value was: None
[2025-04-16T17:36:30.245+0000] {taskinstance.py:1138} INFO - Marking task as SUCCESS. dag_id=enrich_staging_rows, task_id=run_enrich_staging_rows, execution_date=20250416T173606, start_date=20250416T173610, end_date=20250416T173630
[2025-04-16T17:36:30.293+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 0
[2025-04-16T17:36:30.340+0000] {taskinstance.py:3280} INFO - 0 downstream tasks scheduled from follow-on schedule check
